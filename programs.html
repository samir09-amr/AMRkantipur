<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Program Activity Display</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --accent-color: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-in-out;
        }
        
        h1 {
            color: var(--dark-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .admin-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .admin-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .programs-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            padding: 20px;
        }
        
        .program-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            transform-style: preserve-3d;
            transform: perspective(1000px);
            position: relative;
        }
        
        .program-card:hover {
            transform: perspective(1000px) rotateY(10deg) translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .program-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: all 0.5s;
        }
        
        .program-card:hover .program-image {
            transform: scale(1.05);
        }
        
        .program-info {
            padding: 20px;
        }
        
        .program-title {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin-bottom: 10px;
        }
        
        .program-description {
            color: #7f8c8d;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .read-more {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .read-more:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .edit-btn {
            display: inline-block;
            background-color: var(--secondary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 10px;
            border: none;
            cursor: pointer;
        }
        
        .edit-btn:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 1001;
            overflow-y: auto;
            animation: fadeIn 0.3s;
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 900px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            animation: slideDown 0.5s;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            color: #7f8c8d;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-btn:hover {
            color: var(--accent-color);
            transform: rotate(90deg);
        }
        
        .program-details {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .program-header {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .program-header-image {
            width: 300px;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .program-header-text {
            flex: 1;
        }
        
        .program-detail-title {
            font-size: 2rem;
            color: var(--dark-color);
            margin-bottom: 10px;
        }
        
        .program-section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 5px;
        }
        
        .section-content {
            line-height: 1.6;
            color: #34495e;
        }
        
        .program-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
            height: 150px;
            cursor: zoom-in;
        }
        
        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .gallery-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s;
        }
        
        .gallery-item:hover .gallery-image {
            transform: scale(1.1);
        }
        
        .gallery-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px;
            font-size: 0.9rem;
            text-align: center;
            transform: translateY(100%);
            transition: all 0.3s;
        }
        
        .gallery-item:hover .gallery-caption {
            transform: translateY(0);
        }
        
        .location-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .location-icon {
            color: var(--accent-color);
            font-size: 1.2rem;
        }
        
        /* Admin Modal Styles */
        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 1002;
        }
        
        .admin-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            animation: slideDown 0.5s;
        }
        
        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-label {
            font-weight: bold;
            color: var(--dark-color);
        }
        
        .form-input, .form-textarea {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-submit {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .form-submit:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        
        .password-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            max-width: 400px;
            margin: 10% auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: slideDown 0.5s;
        }
        
        .save-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .save-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .file-upload {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .file-upload-label {
            display: inline-block;
            padding: 8px 15px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .file-upload-label:hover {
            background-color: #2980b9;
        }
        
        .file-upload-input {
            display: none;
        }
        
        .file-preview {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 5px;
            display: none;
            margin-top: 10px;
        }
        
        /* Image Preview Modal */
        .image-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            z-index: 1003;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
        }
        
        .image-preview-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
            border-radius: 5px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.5);
            animation: zoomIn 0.3s;
        }
        
        .preview-caption {
            color: white;
            text-align: center;
            margin-top: 15px;
            font-size: 1.2rem;
        }
        
        .close-preview {
            position: absolute;
            top: -40px;
            right: -40px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-preview:hover {
            color: var(--accent-color);
            transform: rotate(90deg);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideDown {
            from { 
                opacity: 0;
                transform: translateY(-50px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes rotate3d {
            0% { transform: perspective(1000px) rotateY(0deg); }
            100% { transform: perspective(1000px) rotateY(360deg); }
        }
        
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .programs-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .program-header {
                flex-direction: column;
            }
            
            .program-header-image {
                width: 100%;
            }
            
            .modal-content, .admin-content {
                width: 95%;
                margin: 2% auto;
                padding: 15px;
            }
            
            .close-preview {
                top: -30px;
                right: 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Our Programs & Activities</h1>
        <p>Explore our initiatives and their impacts</p>
    </header>
    
    <button class="admin-btn" id="adminBtn">Admin Login</button>
    
    <div class="programs-container" id="programsContainer">
        <!-- Programs will be added here dynamically -->
    </div>
    
    <!-- Program Detail Modal -->
    <div class="modal" id="programModal">
        <div class="modal-content">
            <span class="close-btn" id="closeModal">&times;</span>
            <div class="program-details" id="programDetails">
                <!-- Program details will be added here dynamically -->
            </div>
        </div>
    </div>
    
    <!-- Password Modal -->
    <div class="modal" id="passwordModal">
        <div class="password-form">
            <h2>Admin Login</h2>
            <div class="form-group">
                <label for="password" class="form-label">Enter Password:</label>
                <input type="password" id="password" class="form-input" placeholder="Enter admin password">
            </div>
            <button class="form-submit" id="submitPassword">Submit</button>
            <p id="passwordError" style="color: red; display: none;">Incorrect password. Please try again.</p>
        </div>
    </div>
    
    <!-- Admin Modal -->
    <div class="admin-modal" id="adminModal">
        <div class="admin-content">
            <span class="close-btn" id="closeAdminModal">&times;</span>
            <h2 id="adminModalTitle">Add New Program</h2>
            <form class="admin-form" id="programForm">
                <input type="hidden" id="editProgramId" value="">
                <div class="form-group">
                    <label for="programTitle" class="form-label">Program Title:</label>
                    <input type="text" id="programTitle" class="form-input" required>
                </div>
                
                <div class="form-group file-upload">
                    <label class="form-label">Main Display Image:</label>
                    <label for="mainImageUpload" class="file-upload-label">Choose Image</label>
                    <input type="file" id="mainImageUpload" class="file-upload-input" accept="image/*">
                    <img id="mainImagePreview" class="file-preview" src="" alt="Preview">
                </div>
                
                <div class="form-group">
                    <label for="shortDescription" class="form-label">Short Description:</label>
                    <textarea id="shortDescription" class="form-textarea" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="introduction" class="form-label">Introduction:</label>
                    <textarea id="introduction" class="form-textarea" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="objectives" class="form-label">Objectives:</label>
                    <textarea id="objectives" class="form-textarea" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="targetGroup" class="form-label">Expected Target Group:</label>
                    <textarea id="targetGroup" class="form-textarea" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="location" class="form-label">Location:</label>
                    <input type="text" id="location" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="outcomes" class="form-label">Outcomes:</label>
                    <textarea id="outcomes" class="form-textarea" required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Additional Photos:</label>
                    <div id="additionalPhotos">
                        <!-- Photo inputs will be added here dynamically -->
                    </div>
                    <button type="button" class="form-submit" id="addPhotoBtn" style="background-color: var(--primary-color); margin-top: 5px;">Add Another Photo</button>
                </div>
                
                <button type="submit" class="form-submit" id="saveProgramBtn">Save Program</button>
                <button type="button" class="edit-btn" id="cancelEditBtn" style="display: none; background-color: #7f8c8d;">Cancel Edit</button>
            </form>
        </div>
    </div>
    
    <!-- Image Preview Modal -->
    <div class="image-preview-modal" id="imagePreviewModal">
        <div class="image-preview-content">
            <span class="close-preview" id="closePreview">&times;</span>
            <img id="previewImage" class="preview-image" src="" alt="">
            <p id="previewCaption" class="preview-caption"></p>
        </div>
    </div>
    
    <script>
        // Sample data
        let programs = [
            {
                id: 1,
                title: "Community Health Workshop",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' text-anchor='middle' fill='%23000'%3ESample Image 1%3C/text%3E%3C/svg%3E",
                shortDescription: "A workshop to educate community members about basic health practices and prevention.",
                introduction: "The Community Health Workshop was initiated to address the lack of basic health knowledge in rural areas. This program aims to empower individuals with knowledge about common diseases, prevention methods, and basic first aid.",
                objectives: "1. Educate community members about common health issues\n2. Teach basic first aid techniques\n3. Promote preventive healthcare practices\n4. Provide basic health screenings",
                targetGroup: "This program is designed for adults and teenagers in rural communities with limited access to healthcare information.",
                location: "Rural Community Center, Springfield",
                outcomes: "Over 200 community members trained in basic health practices. Increased awareness about preventive healthcare. Establishment of a community health volunteer group.",
                additionalPhotos: [
                    {url: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' text-anchor='middle' fill='%23000'%3EParticipants learning%3C/text%3E%3C/svg%3E", caption: "Participants learning first aid"},
                    {url: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' text-anchor='middle' fill='%23000'%3EHealth screening%3C/text%3E%3C/svg%3E", caption: "Health screening session"}
                ]
            },
            {
                id: 2,
                title: "Youth Leadership Camp",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' text-anchor='middle' fill='%23000'%3ESample Image 2%3C/text%3E%3C/svg%3E",
                shortDescription: "A 5-day camp designed to develop leadership skills in young adults.",
                introduction: "The Youth Leadership Camp was created to nurture the next generation of leaders by providing them with essential skills, confidence, and a network of like-minded peers.",
                objectives: "1. Develop leadership qualities in participants\n2. Enhance communication and teamwork skills\n3. Provide mentorship opportunities\n4. Foster a sense of social responsibility",
                targetGroup: "Young adults aged 16-22 from diverse backgrounds who show leadership potential.",
                location: "Green Valley Retreat Center",
                outcomes: "85% of participants reported increased confidence in leadership roles. Formation of a youth leadership network. Several participants initiated community projects after the camp.",
                additionalPhotos: [
                    {url: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' text-anchor='middle' fill='%23000'%3ETeam building%3C/text%3E%3C/svg%3E", caption: "Team building activity"},
                    {url: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23f0f0f0'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' text-anchor='middle' fill='%23000'%3EGroup discussion%3C/text%3E%3C/svg%3E", caption: "Group discussion session"}
                ]
            }
        ];
        
        // Password for admin access
        const ADMIN_PASSWORD = "admin123";
        
        // DOM Elements
        const programsContainer = document.getElementById('programsContainer');
        const programModal = document.getElementById('programModal');
        const programDetails = document.getElementById('programDetails');
        const closeModal = document.getElementById('closeModal');
        const adminBtn = document.getElementById('adminBtn');
        const passwordModal = document.getElementById('passwordModal');
        const submitPassword = document.getElementById('submitPassword');
        const passwordInput = document.getElementById('password');
        const passwordError = document.getElementById('passwordError');
        const adminModal = document.getElementById('adminModal');
        const closeAdminModal = document.getElementById('closeAdminModal');
        const programForm = document.getElementById('programForm');
        const addPhotoBtn = document.getElementById('addPhotoBtn');
        const additionalPhotos = document.getElementById('additionalPhotos');
        const adminModalTitle = document.getElementById('adminModalTitle');
        const editProgramId = document.getElementById('editProgramId');
        const saveProgramBtn = document.getElementById('saveProgramBtn');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const imagePreviewModal = document.getElementById('imagePreviewModal');
        const previewImage = document.getElementById('previewImage');
        const previewCaption = document.getElementById('previewCaption');
        const closePreview = document.getElementById('closePreview');
        const mainImageUpload = document.getElementById('mainImageUpload');
        const mainImagePreview = document.getElementById('mainImagePreview');
        
        // Track admin login state
        let isAdmin = false;
        
        // Display all programs
        function displayPrograms() {
            programsContainer.innerHTML = '';
            
            programs.forEach(program => {
                const programCard = document.createElement('div');
                programCard.className = 'program-card';
                programCard.innerHTML = `
                    <img src="${program.image}" alt="${program.title}" class="program-image">
                    <div class="program-info">
                        <h3 class="program-title">${program.title}</h3>
                        <p class="program-description">${program.shortDescription}</p>
                        <a href="#" class="read-more" data-id="${program.id}">View Details</a>
                        ${isAdmin ? `<button class="edit-btn" data-id="${program.id}">Edit Program</button>` : ''}
                    </div>
                `;
                
                programsContainer.appendChild(programCard);
            });
            
            // Add event listeners to "View Details" buttons
            document.querySelectorAll('.read-more').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const programId = parseInt(this.getAttribute('data-id'));
                    showProgramDetails(programId);
                });
            });
            
            // Add event listeners to "Edit" buttons if admin
            if (isAdmin) {
                document.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.preventDefault();
                        const programId = parseInt(this.getAttribute('data-id'));
                        editProgram(programId);
                    });
                });
            }
        }
        
        // Show program details in modal
        function showProgramDetails(programId) {
            const program = programs.find(p => p.id === programId);
            
            if (!program) return;
            
            programDetails.innerHTML = `
                <div class="program-header">
                    <img src="${program.image}" alt="${program.title}" class="program-header-image">
                    <div class="program-header-text">
                        <h3 class="program-detail-title">${program.title}</h3>
                        <p class="section-content">${program.shortDescription}</p>
                        ${isAdmin ? `<button class="edit-btn" data-id="${program.id}">Edit Program</button>` : ''}
                    </div>
                </div>
                
                <div class="program-section">
                    <h4 class="section-title">Introduction</h4>
                    <p class="section-content">${program.introduction.replace(/\n/g, '<br>')}</p>
                </div>
                
                <div class="program-section">
                    <h4 class="section-title">Objectives</h4>
                    <p class="section-content">${program.objectives.replace(/\n/g, '<br>')}</p>
                </div>
                
                <div class="program-section">
                    <h4 class="section-title">Expected Target Group</h4>
                    <p class="section-content">${program.targetGroup.replace(/\n/g, '<br>')}</p>
                </div>
                
                <div class="program-section">
                    <h4 class="section-title">Location</h4>
                    <div class="location-info">
                        <span class="location-icon">📍</span>
                        <p class="section-content">${program.location}</p>
                    </div>
                </div>
                
                <div class="program-section">
                    <h4 class="section-title">Outcomes</h4>
                    <p class="section-content">${program.outcomes.replace(/\n/g, '<br>')}</p>
                </div>
                
                ${program.additionalPhotos && program.additionalPhotos.length > 0 ? `
                <div class="program-section">
                    <h4 class="section-title">Gallery</h4>
                    <div class="program-gallery">
                        ${program.additionalPhotos.map(photo => `
                            <div class="gallery-item">
                                <img src="${photo.url}" alt="${photo.caption}" class="gallery-image" data-url="${photo.url}" data-caption="${photo.caption}">
                                <div class="gallery-caption">${photo.caption}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
            `;
            
            // Add event listener to edit button in details modal
            if (isAdmin) {
                const editBtn = programDetails.querySelector('.edit-btn');
                if (editBtn) {
                    editBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        const programId = parseInt(this.getAttribute('data-id'));
                        editProgram(programId);
                    });
                }
            }
            
            // Add event listeners to gallery images
            document.querySelectorAll('.gallery-item img').forEach(img => {
                img.addEventListener('click', function() {
                    showImagePreview(this.getAttribute('data-url'), this.getAttribute('data-caption'));
                });
            });
            
            programModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        // Show image preview modal
        function showImagePreview(url, caption) {
            previewImage.src = url;
            previewCaption.textContent = caption;
            imagePreviewModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        // Close image preview modal
        function closeImagePreview() {
            imagePreviewModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // Edit program
        function editProgram(programId) {
            const program = programs.find(p => p.id === programId);
            if (!program) return;
            
            // Set modal to edit mode
            adminModalTitle.textContent = "Edit Program";
            editProgramId.value = program.id;
            cancelEditBtn.style.display = 'block';
            
            // Fill form with program data
            document.getElementById('programTitle').value = program.title;
            document.getElementById('shortDescription').value = program.shortDescription;
            document.getElementById('introduction').value = program.introduction;
            document.getElementById('objectives').value = program.objectives;
            document.getElementById('targetGroup').value = program.targetGroup;
            document.getElementById('location').value = program.location;
            document.getElementById('outcomes').value = program.outcomes;
            
            // Set main image
            mainImagePreview.src = program.image;
            mainImagePreview.style.display = 'block';
            
            // Clear existing photo inputs
            additionalPhotos.innerHTML = '';
            
            // Add photo inputs for each additional photo
            if (program.additionalPhotos && program.additionalPhotos.length > 0) {
                program.additionalPhotos.forEach(photo => {
                    addPhotoInput(photo.url, photo.caption);
                });
            } else {
                addPhotoInput();
            }
            
            // Close any open modals
            programModal.style.display = 'none';
            passwordModal.style.display = 'none';
            
            // Open admin modal
            adminModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        // Cancel edit mode
        function cancelEdit() {
            adminModalTitle.textContent = "Add New Program";
            editProgramId.value = '';
            cancelEditBtn.style.display = 'none';
            programForm.reset();
            additionalPhotos.innerHTML = '';
            addPhotoInput();
            mainImagePreview.style.display = 'none';
            adminModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // Add new photo input fields
        function addPhotoInput(url = '', caption = '') {
            const photoGroup = document.createElement('div');
            photoGroup.className = 'photo-input-group';
            photoGroup.innerHTML = `
                <div class="file-upload">
                    <label class="file-upload-label">Choose Photo</label>
                    <input type="file" class="file-upload-input additional-image" accept="image/*">
                    <img class="file-preview additional-preview" src="${url}" ${url ? 'style="display: block;"' : ''}>
                </div>
                <input type="text" class="form-input photo-caption" placeholder="Photo Caption" style="margin-top: 5px;" value="${caption}">
                <button type="button" class="form-submit remove-photo-btn" style="background-color: var(--accent-color); margin-top: 5px;">Remove</button>
            `;
            additionalPhotos.appendChild(photoGroup);
            
            // Add event listener to remove button
            const removeBtn = photoGroup.querySelector('.remove-photo-btn');
            removeBtn.addEventListener('click', function() {
                photoGroup.remove();
            });
            
            // Get elements
            const fileLabel = photoGroup.querySelector('.file-upload-label');
            const fileInput = photoGroup.querySelector('.file-upload-input');
            const preview = photoGroup.querySelector('.file-preview');
            
            // Make label clickable
            fileLabel.addEventListener('click', function(e) {
                e.preventDefault();
                fileInput.click();
            });
            
            // Handle file selection
            fileInput.addEventListener('change', function(e) {
                if (fileInput.files && fileInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                }
            });
            
            // If URL was provided, ensure preview is shown
            if (url) {
                preview.src = url;
                preview.style.display = 'block';
            }
        }
        
        // Handle form submission
        function handleFormSubmit(e) {
            e.preventDefault();
            
            // Get all photo URLs and captions
            const photoGroups = document.querySelectorAll('.photo-input-group');
            const photos = [];
            
            photoGroups.forEach(group => {
                const preview = group.querySelector('.additional-preview');
                const caption = group.querySelector('.photo-caption').value;
                
                if (preview.src && caption) {
                    photos.push({
                        url: preview.src,
                        caption: caption
                    });
                }
            });
            
            const programId = editProgramId.value ? parseInt(editProgramId.value) : null;
            
            // Create new or update existing program object
            const programData = {
                id: programId || (programs.length > 0 ? Math.max(...programs.map(p => p.id)) + 1 : 1),
                title: document.getElementById('programTitle').value,
                image: mainImagePreview.src || '',
                shortDescription: document.getElementById('shortDescription').value,
                introduction: document.getElementById('introduction').value,
                objectives: document.getElementById('objectives').value,
                targetGroup: document.getElementById('targetGroup').value,
                location: document.getElementById('location').value,
                outcomes: document.getElementById('outcomes').value,
                additionalPhotos: photos
            };
            
            if (programId) {
                // Update existing program
                const index = programs.findIndex(p => p.id === programId);
                if (index !== -1) {
                    programs[index] = programData;
                }
            } else {
                // Add new program
                programs.push(programData);
            }
            
            // Save to localStorage
            localStorage.setItem('programs', JSON.stringify(programs));
            
            // Refresh display
            displayPrograms();
            
            // Reset form
            programForm.reset();
            additionalPhotos.innerHTML = '';
            addPhotoInput();
            editProgramId.value = '';
            adminModalTitle.textContent = "Add New Program";
            cancelEditBtn.style.display = 'none';
            mainImagePreview.style.display = 'none';
            
            // Close modal
            closeModalFunc();
            
            // Scroll to new/updated program
            setTimeout(() => {
                const newCard = document.querySelector(`.read-more[data-id="${programData.id}"]`);
                if (newCard) {
                    newCard.scrollIntoView({behavior: 'smooth'});
                }
            }, 500);
        }
        
        // Close modal
        function closeModalFunc() {
            programModal.style.display = 'none';
            adminModal.style.display = 'none';
            passwordModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // Show password modal
        function showPasswordModal() {
            passwordModal.style.display = 'block';
            passwordInput.focus();
        }
        
        // Verify password and set admin state
        function verifyPassword() {
            if (passwordInput.value === ADMIN_PASSWORD) {
                isAdmin = true;
                passwordModal.style.display = 'none';
                adminModal.style.display = 'block';
                passwordError.style.display = 'none';
                passwordInput.value = '';
                displayPrograms(); // Refresh to show edit buttons
            } else {
                passwordError.style.display = 'block';
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        
        // Load programs from localStorage
        function loadPrograms() {
            const savedPrograms = localStorage.getItem('programs');
            if (savedPrograms) {
                programs = JSON.parse(savedPrograms);
            }
            displayPrograms();
        }
        
        // Event Listeners
        closeModal.addEventListener('click', closeModalFunc);
        adminBtn.addEventListener('click', showPasswordModal);
        submitPassword.addEventListener('click', verifyPassword);
        closeAdminModal.addEventListener('click', closeModalFunc);
        addPhotoBtn.addEventListener('click', () => addPhotoInput());
        programForm.addEventListener('submit', handleFormSubmit);
        cancelEditBtn.addEventListener('click', cancelEdit);
        closePreview.addEventListener('click', closeImagePreview);
        
        // Main image upload handler
        mainImageUpload.addEventListener('change', function(e) {
            if (mainImageUpload.files && mainImageUpload.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    mainImagePreview.src = e.target.result;
                    mainImagePreview.style.display = 'block';
                };
                reader.readAsDataURL(mainImageUpload.files[0]);
            }
        });
        
        // Also verify password on Enter key
        passwordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                verifyPassword();
            }
        });
        
        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === programModal || e.target === passwordModal || e.target === adminModal) {
                closeModalFunc();
            }
            if (e.target === imagePreviewModal) {
                closeImagePreview();
            }
        });
        
        // Initialize
        loadPrograms();
        addPhotoInput(); // Add one empty photo input by default
    </script>
</body>
</html>